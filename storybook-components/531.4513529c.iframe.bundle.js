"use strict";(self.webpackChunk_baseapp_frontend_components=self.webpackChunk_baseapp_frontend_components||[]).push([[531],{"./__generated__/CommentCreateMutation.graphql.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var v0,v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,node={fragment:{argumentDefinitions:[v0={defaultValue:null,kind:"LocalArgument",name:"connections"},v1={defaultValue:null,kind:"LocalArgument",name:"input"}],kind:"Fragment",metadata:null,name:"CommentCreateMutation",selections:[{alias:null,args:v2=[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"CommentCreatePayload",kind:"LinkedField",name:"commentCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"CommentEdge",kind:"LinkedField",name:"comment",plural:!1,selections:[{alias:null,args:null,concreteType:"Comment",kind:"LinkedField",name:"node",plural:!1,selections:[v3={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:v6=[v3,v5={alias:null,args:null,concreteType:"CommentsCount",kind:"LinkedField",name:"commentsCount",plural:!1,selections:[v4={alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"main",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"replies",storageKey:null}],storageKey:null}],storageKey:null},v7={alias:null,args:null,concreteType:"Comment",kind:"LinkedField",name:"inReplyTo",plural:!1,selections:v6,storageKey:null},{args:null,kind:"FragmentSpread",name:"CommentItem_comment"}],storageKey:null}],storageKey:null},v8={alias:null,args:null,concreteType:"ErrorType",kind:"LinkedField",name:"errors",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"field",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"messages",storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[v1,v0],kind:"Operation",name:"CommentCreateMutation",selections:[{alias:null,args:v2,concreteType:"CommentCreatePayload",kind:"LinkedField",name:"commentCreate",plural:!1,selections:[{alias:null,args:null,concreteType:"CommentEdge",kind:"LinkedField",name:"comment",plural:!1,selections:[{alias:null,args:null,concreteType:"Comment",kind:"LinkedField",name:"node",plural:!1,selections:[v3,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"target",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},v3,v5],storageKey:null},v7,v9={alias:null,args:null,kind:"ScalarField",name:"pk",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"body",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPinned",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[v3,v9,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:50},{kind:"Literal",name:"width",value:50}],concreteType:"File",kind:"LinkedField",name:"avatar",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:"avatar(height:50,width:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"created",storageKey:null},{alias:null,args:null,concreteType:"CommentsCount",kind:"LinkedField",name:"commentsCount",plural:!1,selections:v10=[v4],storageKey:null},{alias:"canChange",args:[{kind:"Literal",name:"perm",value:"change"}],kind:"ScalarField",name:"hasPerm",storageKey:'hasPerm(perm:"change")'},{alias:"canDelete",args:[{kind:"Literal",name:"perm",value:"delete"}],kind:"ScalarField",name:"hasPerm",storageKey:'hasPerm(perm:"delete")'},{alias:"canReport",args:[{kind:"Literal",name:"perm",value:"report"}],kind:"ScalarField",name:"hasPerm",storageKey:'hasPerm(perm:"report")'},{alias:"canPin",args:[{kind:"Literal",name:"perm",value:"pin"}],kind:"ScalarField",name:"hasPerm",storageKey:'hasPerm(perm:"pin")'},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ReactionsCount",kind:"LinkedField",name:"reactionsCount",plural:!1,selections:v10,storageKey:null},{alias:null,args:null,concreteType:"Reaction",kind:"LinkedField",name:"myReaction",plural:!1,selections:[v3,{alias:null,args:null,kind:"ScalarField",name:"reactionType",storageKey:null}],storageKey:null}],type:"ReactionsInterface",abstractKey:"__isReactionsInterface"},{kind:"TypeDiscriminator",abstractKey:"__isCommentsInterface"}],storageKey:null}],storageKey:null},{alias:null,args:null,filters:null,handle:"prependEdge",key:"",kind:"LinkedHandle",name:"comment",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"}]},v8],storageKey:null}]},params:{cacheID:"1df6b1cc4ffb8c4f9160a80391bb797e",id:null,metadata:{},name:"CommentCreateMutation",operationKind:"mutation",text:'mutation CommentCreateMutation(\n  $input: CommentCreateInput!\n) {\n  commentCreate(input: $input) {\n    comment {\n      node {\n        id\n        target {\n          __typename\n          id\n          commentsCount {\n            total\n            main\n            replies\n          }\n        }\n        inReplyTo {\n          id\n          commentsCount {\n            total\n            main\n            replies\n          }\n        }\n        ...CommentItem_comment\n      }\n    }\n    errors {\n      field\n      messages\n    }\n  }\n}\n\nfragment CommentItem_comment on Comment {\n  id\n  pk\n  body\n  isPinned\n  user {\n    id\n    pk\n    fullName\n    avatar(width: 50, height: 50) {\n      url\n    }\n  }\n  created\n  commentsCount {\n    total\n  }\n  canChange: hasPerm(perm: "change")\n  canDelete: hasPerm(perm: "delete")\n  canReport: hasPerm(perm: "report")\n  canPin: hasPerm(perm: "pin")\n  ...ReactionButton_target\n  ...CommentItem_target\n}\n\nfragment CommentItem_target on CommentsInterface {\n  __isCommentsInterface: __typename\n  id\n}\n\nfragment ReactionButton_target on ReactionsInterface {\n  __isReactionsInterface: __typename\n  id\n  reactionsCount {\n    total\n  }\n  myReaction {\n    id\n    reactionType\n  }\n}\n'}};node.hash="a8c11febd85db3454fcae2f3629bdff2";const __WEBPACK_DEFAULT_EXPORT__=node},"./modules/social/CommentCreate/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>social_CommentCreate});var _CommentCreateMutation,react=__webpack_require__("../../node_modules/react/index.js"),design_system=__webpack_require__("../design-system/index.ts"),utils=__webpack_require__("../utils/index.ts"),zod=__webpack_require__("../../node_modules/@hookform/resolvers/zod/dist/zod.mjs"),index_esm=__webpack_require__("../../node_modules/react-hook-form/dist/index.esm.mjs"),react_relay=__webpack_require__("../../node_modules/react-relay/index.js"),social_CommentUpsertActions=__webpack_require__("./modules/social/CommentUpsertActions/index.tsx"),constants=__webpack_require__("./modules/social/constants.ts"),comments=__webpack_require__("./modules/social/context/comments/index.ts");function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(e,r,t){return(r=function _toPropertyKey(t){var i=function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _slicedToArray(r,e){return function _arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r,e)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var CommentCreateMutationQuery=void 0!==_CommentCreateMutation?_CommentCreateMutation:_CommentCreateMutation=__webpack_require__("./__generated__/CommentCreateMutation.graphql.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function CommentCreate_typeof(o){return CommentCreate_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},CommentCreate_typeof(o)}function CommentCreate_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function CommentCreate_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CommentCreate_ownKeys(Object(t),!0).forEach((function(r){CommentCreate_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CommentCreate_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function CommentCreate_defineProperty(e,r,t){return(r=function CommentCreate_toPropertyKey(t){var i=function CommentCreate_toPrimitive(t,r){if("object"!=CommentCreate_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=CommentCreate_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==CommentCreate_typeof(i)?i:i+""}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function CommentCreate_slicedToArray(r,e){return function CommentCreate_arrayWithHoles(r){if(Array.isArray(r))return r}(r)||function CommentCreate_iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(r,e)||function CommentCreate_unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return CommentCreate_arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?CommentCreate_arrayLikeToArray(r,a):void 0}}(r,e)||function CommentCreate_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CommentCreate_arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}var nextClientMutationId=0,CommentCreate=(0,react.forwardRef)((function(_ref,ref){var targetObjectId=_ref.targetObjectId,_ref$placeholder=_ref.placeholder,placeholder=void 0===_ref$placeholder?"Comment...":_ref$placeholder,profileId=_ref.profileId,autoFocusInput=_ref.autoFocusInput,CommentTextFieldProps=_ref.CommentTextFieldProps,_ref$CommentTextField=_ref.CommentTextField,CommentTextField=void 0===_ref$CommentTextField?design_system.PM:_ref$CommentTextField,_ref$CommentUpsertAct=_ref.CommentUpsertActions,CommentUpsertActions=void 0===_ref$CommentUpsertAct?social_CommentUpsertActions.A:_ref$CommentUpsertAct,_ref$SendMessageIcon=_ref.SendMessageIcon,SendMessageIcon=void 0===_ref$SendMessageIcon?design_system.lX:_ref$SendMessageIcon,commentReply=(0,comments.lr)(),isReply=!!commentReply.inReplyToId,form=(0,index_esm.mN)({defaultValues:constants.yC,resolver:(0,zod.u)(constants.sD)}),_useCommentCreateMuta=function useCommentCreateMutation(){var sendToast=(0,utils.hN)().sendToast,_useMutation2=_slicedToArray((0,react_relay.useMutation)(CommentCreateMutationQuery),2),commitMutation=_useMutation2[0];return[function commit(config){return commitMutation(_objectSpread(_objectSpread({},config),{},{onCompleted:function onCompleted(response,errors){var _config$onCompleted;null==errors||errors.forEach((function(error){sendToast(error.message,{type:"error"})})),null==config||null===(_config$onCompleted=config.onCompleted)||void 0===_config$onCompleted||_config$onCompleted.call(config,response,errors)},onError:function onError(error){var _config$onError;sendToast(error.message,{type:"error"}),null==config||null===(_config$onError=config.onError)||void 0===_config$onError||_config$onError.call(config,error)}}))},_useMutation2[1]]}(),_useCommentCreateMuta2=CommentCreate_slicedToArray(_useCommentCreateMuta,2),commitMutation=_useCommentCreateMuta2[0],isMutationInFlight=_useCommentCreateMuta2[1],onSubmit=function onSubmit(data){var _commentReply$inReply;if(isMutationInFlight)return null;var clientMutationId=(nextClientMutationId+=1).toString(),connectionID=react_relay.ConnectionHandler.getConnectionID(null!==(_commentReply$inReply=commentReply.inReplyToId)&&void 0!==_commentReply$inReply?_commentReply$inReply:targetObjectId,"CommentsList_comments");return commitMutation({variables:{input:CommentCreate_objectSpread(CommentCreate_objectSpread({},data),{},{targetObjectId,inReplyToId:commentReply.inReplyToId,profileId,clientMutationId}),connections:[connectionID]},onCompleted:function onCompleted(response,errors){var _response$commentCrea;if(errors)console.error(errors);else{var _commentReply$comment,mutationErrors=null==response||null===(_response$commentCrea=response.commentCreate)||void 0===_response$commentCrea?void 0:_response$commentCrea.errors;if((0,utils.Bq)(form,mutationErrors),null==mutationErrors||!mutationErrors.length)commentReply.resetCommentReply(),form.reset(),null!==(_commentReply$comment=commentReply.commentItemRef)&&void 0!==_commentReply$comment&&_commentReply$comment.current&&commentReply.commentItemRef.current.scrollIntoView({block:"nearest",inline:"start",behavior:"smooth"})}},onError:console.error}),null},isCreateButtonDisabled=isMutationInFlight||!form.formState.isValid;return(0,jsx_runtime.jsx)("form",{id:"comment-create",onSubmit:form.handleSubmit(onSubmit),className:"sticky bottom-0 z-10 bg-common-white pb-4",children:(0,jsx_runtime.jsxs)(CommentTextField,CommentCreate_objectSpread(CommentCreate_objectSpread({inputRef:ref,name:constants.f5.body,control:form.control,onKeyDown:function handleKeyDown(event){"Enter"!==event.key||event.shiftKey||(event.preventDefault(),form.handleSubmit(onSubmit)(event))},placeholder,autoFocus:autoFocusInput,isReply,replyTargetName:commentReply.name,onCancelReply:commentReply.resetCommentReply},CommentTextFieldProps),{},{children:[(0,jsx_runtime.jsx)(CommentUpsertActions,{}),(0,jsx_runtime.jsx)(design_system.K0,{type:"submit",form:"comment-create",disabled:isCreateButtonDisabled,"aria-label":"create comment",children:(0,jsx_runtime.jsx)(SendMessageIcon,{})})]}))})}));const social_CommentCreate=CommentCreate;CommentCreate.__docgenInfo={description:"",methods:[],displayName:"CommentCreate",props:{placeholder:{defaultValue:{value:"'Comment...'",computed:!1},required:!1},CommentTextField:{defaultValue:{value:'({\n  children,\n  isReply,\n  replyTargetName,\n  onCancelReply,\n  ...props\n}) => (\n  <Container>\n    {isReply && (\n      <OutsideReplyContainer>\n        <div className="flex w-full justify-between rounded-md bg-background-neutral px-2 py-1">\n          <ReplyContainer>\n            <CommentReplyIcon />\n            <Typography variant="body2" color="text.secondary">\n              Replying to\n            </Typography>\n            <TypographyWithEllipsis maxWidth={170} variant="body2" color="primary.light">\n              {replyTargetName}\n            </TypographyWithEllipsis>\n          </ReplyContainer>\n          <IconButton onClick={onCancelReply} aria-label="cancel reply">\n            <CloseIcon />\n          </IconButton>\n        </div>\n      </OutsideReplyContainer>\n    )}\n    <TextareaField {...props} />\n    <div className="flex justify-between px-3 pb-3">{children}</div>\n  </Container>\n)',computed:!1},required:!1},CommentUpsertActions:{defaultValue:{value:'() => (\n  <div className="grid grid-cols-[repeat(2,max-content)] gap-2">\n    <IconButton disabled>\n      <AttachmentIcon />\n    </IconButton>\n    <IconButton disabled>\n      <MentionIcon />\n    </IconButton>\n  </div>\n)',computed:!1},required:!1},SendMessageIcon:{defaultValue:{value:'({ sx, ...props }) => (\n  <SvgIcon sx={{ fontSize: 16, color: \'primary.main\', ...sx }} {...props}>\n    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="15" viewBox="0 0 16 15" fill="none">\n      <path\n        fillRule="evenodd"\n        clipRule="evenodd"\n        d="M15.575 1.3C15.2 0.625 14.525 0.25 13.775 0.25H2.525C1.7 0.25 0.95 0.775 0.65 1.6C0.35 2.425 0.5 3.25 1.1 3.85L3.95 6.7L11.15 3.325C11.525 3.175 11.825 3.7 11.45 3.925L4.925 8.275L5.975 12.625C6.2 13.45 6.875 14.05 7.7 14.2C8.525 14.35 9.35 13.9 9.8 13.225L15.575 3.475C15.95 2.8 15.95 1.975 15.575 1.3Z"\n        fill="currentColor"\n      />\n    </svg>\n  </SvgIcon>\n)',computed:!1},required:!1}}}}}]);